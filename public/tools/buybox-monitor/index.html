<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy Box & Pricing Monitor | Glue Masters</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        .gradient-bg { background: linear-gradient(135deg, #1a2f4a 0%, #0d1b2a 100%); }
        .card { background: rgba(30, 41, 59, 0.85); backdrop-filter: blur(10px); }
        .bb-own { background: linear-gradient(90deg, #22c55e, #16a34a); }
        .bb-lost { background: linear-gradient(90deg, #dc2626, #b91c1c); }
        .bb-mixed { background: linear-gradient(90deg, #f59e0b, #d97706); }
        .price-up { color: #ef4444; }
        .price-down { color: #22c55e; }
        .trend-up::before { content: "‚Üë "; }
        .trend-down::before { content: "‚Üì "; }
    </style>
</head>
<body class="gradient-bg min-h-screen text-white">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="flex items-center justify-between mb-8">
            <div>
                <h1 class="text-3xl font-bold">üí∞ Buy Box & Pricing Monitor</h1>
                <p class="text-gray-400 mt-1">Track Buy Box ownership and competitive pricing</p>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="refreshData()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center gap-2">
                    üîÑ Refresh
                </button>
                <div class="text-right">
                    <div class="text-sm text-gray-400">Last Updated</div>
                    <div id="lastUpdated" class="font-mono">--</div>
                </div>
            </div>
        </div>

        <!-- Summary Cards -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="card rounded-xl p-6">
                <div class="text-sm text-gray-400 mb-2">Total ASINs Tracked</div>
                <div id="totalAsins" class="text-3xl font-bold">0</div>
            </div>
            <div class="card rounded-xl p-6">
                <div class="text-sm text-gray-400 mb-2">Avg Buy Box %</div>
                <div id="avgBuyBox" class="text-3xl font-bold text-green-400">--%</div>
            </div>
            <div class="card rounded-xl p-6">
                <div class="text-sm text-gray-400 mb-2">At Risk (&lt;95%)</div>
                <div id="atRiskCount" class="text-3xl font-bold text-yellow-400">0</div>
            </div>
            <div class="card rounded-xl p-6">
                <div class="text-sm text-gray-400 mb-2">Lost Buy Box</div>
                <div id="lostCount" class="text-3xl font-bold text-red-400">0</div>
            </div>
        </div>

        <!-- Add ASIN Form -->
        <div class="card rounded-xl p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4">‚ûï Add ASIN to Monitor</h2>
            <div class="flex gap-4 flex-wrap">
                <input type="text" id="newAsin" placeholder="B01MDNS8QB" 
                    class="flex-1 min-w-48 bg-slate-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="text" id="newName" placeholder="Product name" 
                    class="flex-1 min-w-48 bg-slate-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="number" step="0.01" id="newPrice" placeholder="Your price ($)" 
                    class="w-32 bg-slate-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="number" step="0.1" id="newBuyBoxPct" placeholder="Buy Box %" 
                    class="w-32 bg-slate-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <button onclick="addAsin()" class="px-6 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-semibold">
                    Add
                </button>
            </div>
        </div>

        <!-- ASIN List -->
        <div class="card rounded-xl p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4">üìä Monitored ASINs</h2>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="text-left text-gray-400 text-sm border-b border-slate-700">
                            <th class="pb-3 pr-4">ASIN</th>
                            <th class="pb-3 pr-4">Product</th>
                            <th class="pb-3 pr-4">Your Price</th>
                            <th class="pb-3 pr-4">Buy Box %</th>
                            <th class="pb-3 pr-4">Status</th>
                            <th class="pb-3 pr-4">Trend</th>
                            <th class="pb-3 pr-4">Competitors</th>
                            <th class="pb-3">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="asinTable">
                        <!-- Data rows inserted here -->
                    </tbody>
                </table>
            </div>
            <div id="emptyState" class="text-center py-12 text-gray-500 hidden">
                No ASINs being monitored. Add one above to get started.
            </div>
        </div>

        <!-- Selected ASIN Detail -->
        <div id="detailPanel" class="hidden">
            <div class="card rounded-xl p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold" id="detailTitle">ASIN Details</h2>
                    <button onclick="closeDetail()" class="text-gray-400 hover:text-white">‚úï Close</button>
                </div>
                
                <!-- Buy Box History Chart -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium mb-4">üìà Buy Box % History</h3>
                    <div class="bg-slate-800 rounded-lg p-4" style="height: 300px;">
                        <canvas id="buyBoxChart"></canvas>
                    </div>
                </div>

                <!-- Competitor Table -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium mb-4">‚öîÔ∏è Competitor Pricing</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="text-left text-gray-400 border-b border-slate-700">
                                    <th class="pb-2 pr-4">Seller</th>
                                    <th class="pb-2 pr-4">Price</th>
                                    <th class="pb-2 pr-4">Shipping</th>
                                    <th class="pb-2 pr-4">Total</th>
                                    <th class="pb-2 pr-4">Rating</th>
                                    <th class="pb-2">Fulfillment</th>
                                </tr>
                            </thead>
                            <tbody id="competitorTable">
                                <!-- Competitor rows -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Price History -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium mb-4">üíµ Price History</h3>
                    <div class="bg-slate-800 rounded-lg p-4" style="height: 250px;">
                        <canvas id="priceChart"></canvas>
                    </div>
                </div>

                <!-- Log Entry -->
                <div>
                    <h3 class="text-lg font-medium mb-4">üìù Add Price Check Log</h3>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-4">
                        <input type="number" step="0.01" id="logPrice" placeholder="Your price" 
                            class="bg-slate-700 rounded px-3 py-2 text-sm">
                        <input type="number" step="0.1" id="logBuyBox" placeholder="Buy Box %" 
                            class="bg-slate-700 rounded px-3 py-2 text-sm">
                        <input type="number" step="0.01" id="logCompPrice" placeholder="Lowest comp price" 
                            class="bg-slate-700 rounded px-3 py-2 text-sm">
                        <input type="text" id="logCompName" placeholder="Competitor name" 
                            class="bg-slate-700 rounded px-3 py-2 text-sm">
                        <button onclick="addLogEntry()" class="bg-blue-600 hover:bg-blue-700 rounded px-4 py-2 text-sm font-medium">
                            Log Check
                        </button>
                    </div>
                    <div id="logHistory" class="space-y-2 max-h-48 overflow-y-auto">
                        <!-- Log entries -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis & Recommendations -->
        <div class="card rounded-xl p-6">
            <h2 class="text-xl font-semibold mb-4">üéØ Analysis & Recommendations</h2>
            <div id="recommendations" class="space-y-4">
                <!-- Generated recommendations -->
            </div>
        </div>
    </div>

    <script>
        // Storage
        const STORAGE_KEY = 'buyBoxMonitor';
        
        let state = {
            asins: [],
            selectedAsin: null
        };

        let buyBoxChart = null;
        let priceChart = null;

        // Initialize
        function init() {
            loadState();
            
            // Pre-populate with 2oz Medium if empty
            if (state.asins.length === 0) {
                state.asins.push({
                    id: 'asin_' + Date.now(),
                    asin: 'B01MDNS8QB',
                    name: '2oz Medium CA Glue',
                    ourPrice: 12.99,
                    currentBuyBox: 94.1,
                    previousBuyBox: 98.7,
                    status: 'at-risk',
                    competitors: [
                        { name: 'Unknown Seller', price: 12.49, shipping: 0, rating: 92, fulfillment: 'FBA' }
                    ],
                    history: [
                        { date: '2025-12-29', buyBox: 98.7, ourPrice: 12.99, lowestComp: 13.49 },
                        { date: '2026-01-05', buyBox: 97.2, ourPrice: 12.99, lowestComp: 12.99 },
                        { date: '2026-01-12', buyBox: 95.8, ourPrice: 12.99, lowestComp: 12.79 },
                        { date: '2026-01-19', buyBox: 94.5, ourPrice: 12.99, lowestComp: 12.49 },
                        { date: '2026-01-29', buyBox: 94.1, ourPrice: 12.99, lowestComp: 12.49 }
                    ],
                    logs: [],
                    createdAt: new Date().toISOString()
                });
                saveState();
            }
            
            render();
            updateTimestamp();
        }

        function loadState() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                state = JSON.parse(saved);
            }
        }

        function saveState() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        }

        function updateTimestamp() {
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        }

        function render() {
            updateSummary();
            renderAsinTable();
            renderRecommendations();
            
            if (state.selectedAsin) {
                showDetail(state.selectedAsin);
            }
        }

        function updateSummary() {
            document.getElementById('totalAsins').textContent = state.asins.length;
            
            if (state.asins.length > 0) {
                const avgBB = state.asins.reduce((sum, a) => sum + a.currentBuyBox, 0) / state.asins.length;
                document.getElementById('avgBuyBox').textContent = avgBB.toFixed(1) + '%';
                
                const atRisk = state.asins.filter(a => a.currentBuyBox >= 85 && a.currentBuyBox < 95).length;
                document.getElementById('atRiskCount').textContent = atRisk;
                
                const lost = state.asins.filter(a => a.currentBuyBox < 85).length;
                document.getElementById('lostCount').textContent = lost;
            }
        }

        function renderAsinTable() {
            const tbody = document.getElementById('asinTable');
            const empty = document.getElementById('emptyState');
            
            if (state.asins.length === 0) {
                tbody.innerHTML = '';
                empty.classList.remove('hidden');
                return;
            }
            
            empty.classList.add('hidden');
            
            tbody.innerHTML = state.asins.map(asin => {
                const trend = asin.previousBuyBox ? asin.currentBuyBox - asin.previousBuyBox : 0;
                const trendClass = trend > 0 ? 'text-green-400 trend-up' : trend < 0 ? 'text-red-400 trend-down' : 'text-gray-400';
                const statusClass = asin.currentBuyBox >= 95 ? 'bg-green-600' : 
                                   asin.currentBuyBox >= 85 ? 'bg-yellow-600' : 'bg-red-600';
                const statusText = asin.currentBuyBox >= 95 ? 'Healthy' : 
                                  asin.currentBuyBox >= 85 ? 'At Risk' : 'Critical';
                const lowestComp = asin.competitors.length > 0 ? 
                    Math.min(...asin.competitors.map(c => c.price + c.shipping)) : '-';
                
                return `
                    <tr class="border-b border-slate-700/50 hover:bg-slate-700/30 cursor-pointer" onclick="showDetail('${asin.id}')">
                        <td class="py-4 pr-4 font-mono text-blue-400">${asin.asin}</td>
                        <td class="py-4 pr-4">${asin.name}</td>
                        <td class="py-4 pr-4 font-mono">$${asin.ourPrice.toFixed(2)}</td>
                        <td class="py-4 pr-4 font-bold ${asin.currentBuyBox >= 95 ? 'text-green-400' : asin.currentBuyBox >= 85 ? 'text-yellow-400' : 'text-red-400'}">
                            ${asin.currentBuyBox.toFixed(1)}%
                        </td>
                        <td class="py-4 pr-4">
                            <span class="px-2 py-1 rounded text-xs ${statusClass}">${statusText}</span>
                        </td>
                        <td class="py-4 pr-4 ${trendClass}">
                            ${trend !== 0 ? (trend > 0 ? '+' : '') + trend.toFixed(1) + '%' : '-'}
                        </td>
                        <td class="py-4 pr-4">
                            ${lowestComp !== '-' ? '$' + lowestComp.toFixed(2) : '-'}
                            ${asin.competitors.length > 0 ? `<span class="text-gray-500 text-xs">(${asin.competitors.length})</span>` : ''}
                        </td>
                        <td class="py-4">
                            <button onclick="event.stopPropagation(); deleteAsin('${asin.id}')" 
                                class="text-red-400 hover:text-red-300 text-sm">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function addAsin() {
            const asin = document.getElementById('newAsin').value.trim().toUpperCase();
            const name = document.getElementById('newName').value.trim();
            const price = parseFloat(document.getElementById('newPrice').value) || 0;
            const buyBox = parseFloat(document.getElementById('newBuyBoxPct').value) || 100;

            if (!asin) {
                alert('Please enter an ASIN');
                return;
            }

            // Check for duplicate
            if (state.asins.some(a => a.asin === asin)) {
                alert('This ASIN is already being monitored');
                return;
            }

            state.asins.push({
                id: 'asin_' + Date.now(),
                asin,
                name: name || asin,
                ourPrice: price,
                currentBuyBox: buyBox,
                previousBuyBox: null,
                status: buyBox >= 95 ? 'healthy' : buyBox >= 85 ? 'at-risk' : 'critical',
                competitors: [],
                history: [{
                    date: new Date().toISOString().split('T')[0],
                    buyBox,
                    ourPrice: price,
                    lowestComp: null
                }],
                logs: [],
                createdAt: new Date().toISOString()
            });

            // Clear form
            document.getElementById('newAsin').value = '';
            document.getElementById('newName').value = '';
            document.getElementById('newPrice').value = '';
            document.getElementById('newBuyBoxPct').value = '';

            saveState();
            render();
        }

        function deleteAsin(id) {
            if (!confirm('Remove this ASIN from monitoring?')) return;
            state.asins = state.asins.filter(a => a.id !== id);
            if (state.selectedAsin === id) {
                state.selectedAsin = null;
                document.getElementById('detailPanel').classList.add('hidden');
            }
            saveState();
            render();
        }

        function showDetail(id) {
            const asin = state.asins.find(a => a.id === id);
            if (!asin) return;

            state.selectedAsin = id;
            document.getElementById('detailPanel').classList.remove('hidden');
            document.getElementById('detailTitle').textContent = `${asin.name} (${asin.asin})`;

            // Render competitor table
            const compTable = document.getElementById('competitorTable');
            if (asin.competitors.length === 0) {
                compTable.innerHTML = '<tr><td colspan="6" class="py-4 text-center text-gray-500">No competitors logged yet</td></tr>';
            } else {
                compTable.innerHTML = asin.competitors.map(c => `
                    <tr class="border-b border-slate-700/30">
                        <td class="py-2 pr-4">${c.name}</td>
                        <td class="py-2 pr-4 font-mono ${c.price < asin.ourPrice ? 'text-red-400' : 'text-green-400'}">$${c.price.toFixed(2)}</td>
                        <td class="py-2 pr-4 font-mono">${c.shipping > 0 ? '$' + c.shipping.toFixed(2) : 'Free'}</td>
                        <td class="py-2 pr-4 font-mono font-bold">$${(c.price + c.shipping).toFixed(2)}</td>
                        <td class="py-2 pr-4">${c.rating}%</td>
                        <td class="py-2">${c.fulfillment}</td>
                    </tr>
                `).join('');
            }

            // Render log history
            const logHistory = document.getElementById('logHistory');
            if (asin.logs.length === 0) {
                logHistory.innerHTML = '<p class="text-gray-500 text-sm">No log entries yet. Use the form above to record price checks.</p>';
            } else {
                logHistory.innerHTML = asin.logs.slice(-10).reverse().map(log => `
                    <div class="bg-slate-700/50 rounded px-3 py-2 text-sm flex justify-between">
                        <span class="text-gray-400">${new Date(log.date).toLocaleString()}</span>
                        <span>BB: <span class="font-bold">${log.buyBox}%</span></span>
                        <span>Our: $${log.ourPrice.toFixed(2)}</span>
                        ${log.lowestComp ? `<span>Comp: $${log.lowestComp.toFixed(2)} (${log.compName || '?'})</span>` : ''}
                    </div>
                `).join('');
            }

            // Render charts
            renderBuyBoxChart(asin);
            renderPriceChart(asin);
            
            saveState();
        }

        function closeDetail() {
            state.selectedAsin = null;
            document.getElementById('detailPanel').classList.add('hidden');
            saveState();
        }

        function renderBuyBoxChart(asin) {
            const ctx = document.getElementById('buyBoxChart').getContext('2d');
            
            if (buyBoxChart) {
                buyBoxChart.destroy();
            }

            const data = asin.history.map(h => ({
                x: new Date(h.date),
                y: h.buyBox
            }));

            buyBoxChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Buy Box %',
                        data: data,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'time',
                            time: { unit: 'day' },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#9ca3af' }
                        },
                        y: {
                            min: 0,
                            max: 100,
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#9ca3af', callback: v => v + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        annotation: {
                            annotations: {
                                threshold: {
                                    type: 'line',
                                    yMin: 95,
                                    yMax: 95,
                                    borderColor: '#f59e0b',
                                    borderWidth: 2,
                                    borderDash: [5, 5],
                                    label: {
                                        display: true,
                                        content: '95% threshold',
                                        position: 'end'
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        function renderPriceChart(asin) {
            const ctx = document.getElementById('priceChart').getContext('2d');
            
            if (priceChart) {
                priceChart.destroy();
            }

            const ourPrices = asin.history.filter(h => h.ourPrice).map(h => ({
                x: new Date(h.date),
                y: h.ourPrice
            }));

            const compPrices = asin.history.filter(h => h.lowestComp).map(h => ({
                x: new Date(h.date),
                y: h.lowestComp
            }));

            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [
                        {
                            label: 'Our Price',
                            data: ourPrices,
                            borderColor: '#22c55e',
                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                            tension: 0.1,
                            pointRadius: 4
                        },
                        {
                            label: 'Lowest Competitor',
                            data: compPrices,
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.1,
                            pointRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'time',
                            time: { unit: 'day' },
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#9ca3af' }
                        },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#9ca3af', callback: v => '$' + v.toFixed(2) }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }

        function addLogEntry() {
            const asin = state.asins.find(a => a.id === state.selectedAsin);
            if (!asin) return;

            const price = parseFloat(document.getElementById('logPrice').value);
            const buyBox = parseFloat(document.getElementById('logBuyBox').value);
            const compPrice = parseFloat(document.getElementById('logCompPrice').value);
            const compName = document.getElementById('logCompName').value.trim();

            if (!buyBox) {
                alert('Please enter at least the Buy Box %');
                return;
            }

            // Update current values
            asin.previousBuyBox = asin.currentBuyBox;
            asin.currentBuyBox = buyBox;
            if (price) asin.ourPrice = price;

            // Add to history
            asin.history.push({
                date: new Date().toISOString().split('T')[0],
                buyBox,
                ourPrice: price || asin.ourPrice,
                lowestComp: compPrice || null
            });

            // Add to logs
            asin.logs.push({
                date: new Date().toISOString(),
                buyBox,
                ourPrice: price || asin.ourPrice,
                lowestComp: compPrice || null,
                compName: compName || null
            });

            // Add competitor if new
            if (compPrice && compName && !asin.competitors.some(c => c.name === compName)) {
                asin.competitors.push({
                    name: compName,
                    price: compPrice,
                    shipping: 0,
                    rating: 90,
                    fulfillment: 'Unknown'
                });
            }

            // Clear form
            document.getElementById('logPrice').value = '';
            document.getElementById('logBuyBox').value = '';
            document.getElementById('logCompPrice').value = '';
            document.getElementById('logCompName').value = '';

            saveState();
            showDetail(asin.id);
            render();
        }

        function renderRecommendations() {
            const container = document.getElementById('recommendations');
            const recommendations = [];

            state.asins.forEach(asin => {
                // Check for declining trend
                if (asin.history.length >= 3) {
                    const recent = asin.history.slice(-3);
                    const declining = recent[0].buyBox > recent[1].buyBox && recent[1].buyBox > recent[2].buyBox;
                    if (declining) {
                        recommendations.push({
                            severity: 'high',
                            asin: asin.asin,
                            name: asin.name,
                            title: 'Declining Buy Box trend detected',
                            detail: `Buy Box dropped from ${recent[0].buyBox}% to ${recent[2].buyBox}% over recent period.`,
                            action: 'Investigate competitor pricing and review Buy Box eligibility factors.'
                        });
                    }
                }

                // Check for price undercut
                const lowestComp = asin.competitors.length > 0 ? 
                    Math.min(...asin.competitors.map(c => c.price + c.shipping)) : null;
                if (lowestComp && lowestComp < asin.ourPrice) {
                    const diff = ((asin.ourPrice - lowestComp) / asin.ourPrice * 100).toFixed(1);
                    recommendations.push({
                        severity: 'medium',
                        asin: asin.asin,
                        name: asin.name,
                        title: 'Competitor underpricing detected',
                        detail: `Competitor at $${lowestComp.toFixed(2)} vs your $${asin.ourPrice.toFixed(2)} (${diff}% lower).`,
                        action: 'Consider adjusting price or improving listing value proposition.'
                    });
                }

                // Critical Buy Box loss
                if (asin.currentBuyBox < 85) {
                    recommendations.push({
                        severity: 'critical',
                        asin: asin.asin,
                        name: asin.name,
                        title: 'Critical Buy Box loss',
                        detail: `Only ${asin.currentBuyBox}% Buy Box ownership.`,
                        action: 'Immediately investigate: pricing, inventory, account health, and seller metrics.'
                    });
                }
            });

            if (recommendations.length === 0) {
                container.innerHTML = '<p class="text-gray-500">No urgent recommendations. All monitored ASINs look healthy.</p>';
                return;
            }

            container.innerHTML = recommendations.map(rec => {
                const severityColor = rec.severity === 'critical' ? 'border-red-500 bg-red-900/20' :
                                     rec.severity === 'high' ? 'border-yellow-500 bg-yellow-900/20' :
                                     'border-blue-500 bg-blue-900/20';
                const icon = rec.severity === 'critical' ? 'üö®' : rec.severity === 'high' ? '‚ö†Ô∏è' : 'üí°';
                
                return `
                    <div class="border-l-4 ${severityColor} rounded-r-lg p-4">
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">${icon}</span>
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="font-semibold">${rec.title}</span>
                                    <span class="text-xs text-gray-400 font-mono">${rec.asin}</span>
                                </div>
                                <p class="text-sm text-gray-300 mb-2">${rec.detail}</p>
                                <p class="text-sm text-blue-400">üìã ${rec.action}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function refreshData() {
            updateTimestamp();
            render();
            alert('Data refreshed. For live price/competitor data, manually check Seller Central and add log entries.');
        }

        // Initialize
        init();
    </script>
</body>
</html>
